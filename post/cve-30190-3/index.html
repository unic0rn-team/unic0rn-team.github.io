<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>
        CVE-2022-30190 &#34;Follina&#34; - part 3 ::
        unic0rn-team&#39;s billets — unic0rn-team&#39;s musings
      </title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="# Billet 3 TL-DR; Dès lors que des démonstrateurs (POCs) sont publiés, il n&amp;rsquo;est qu&amp;rsquo;une question de temps avant que les acteurs malveillants (&amp;quot;threat actors&amp;rdquo; - TA) ne s&amp;rsquo;emparent de l&amp;rsquo;exploit pour l&amp;rsquo;incorporer dans leur arsenal, tout d&amp;rsquo;abord pour profiter du fameux &amp;ldquo;dwell time&amp;rdquo; (le temps écoulé entre la publication d&amp;rsquo;une vulnérabilité et l&amp;rsquo;application de son correctif).
Ainsi, des nombreux TA ont armé la vulnérabilité dans leur kit d&amp;rsquo;exploitation en modifiant leurs mode opératoire (TTPs) en conséquence, avec un succès assez variable."
/>
<meta
  name="keywords"
  content=""
/>
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://unic0rn-team.github.io/post/cve-30190-3/" />





<link rel="stylesheet" href="https://unic0rn-team.github.io/assets/style.css" />

<link rel="stylesheet" href="https://unic0rn-team.github.io/style.css" />


<link
  rel="apple-touch-icon-precomposed"
  sizes="144x144"
  href="https://unic0rn-team.github.io/img/apple-touch-icon-144-precomposed.png"
/>
<link rel="shortcut icon" href="https://unic0rn-team.github.io/img/favicon.png" />


<link href="https://unic0rn-team.github.io/assets/fonts/Inter-Italic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://unic0rn-team.github.io/assets/fonts/Inter-Regular.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://unic0rn-team.github.io/assets/fonts/Inter-Medium.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://unic0rn-team.github.io/assets/fonts/Inter-MediumItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://unic0rn-team.github.io/assets/fonts/Inter-Bold.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="https://unic0rn-team.github.io/assets/fonts/Inter-BoldItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="CVE-2022-30190 &#34;Follina&#34; - part 3"/>
<meta name="twitter:description" content="# Billet 3 TL-DR; Dès lors que des démonstrateurs (POCs) sont publiés, il n&rsquo;est qu&rsquo;une question de temps avant que les acteurs malveillants (&quot;threat actors&rdquo; - TA) ne s&rsquo;emparent de l&rsquo;exploit pour l&rsquo;incorporer dans leur arsenal, tout d&rsquo;abord pour profiter du fameux &ldquo;dwell time&rdquo; (le temps écoulé entre la publication d&rsquo;une vulnérabilité et l&rsquo;application de son correctif).
Ainsi, des nombreux TA ont armé la vulnérabilité dans leur kit d&rsquo;exploitation en modifiant leurs mode opératoire (TTPs) en conséquence, avec un succès assez variable."/>



<meta property="og:title" content="CVE-2022-30190 &#34;Follina&#34; - part 3" />
<meta property="og:description" content="# Billet 3 TL-DR; Dès lors que des démonstrateurs (POCs) sont publiés, il n&rsquo;est qu&rsquo;une question de temps avant que les acteurs malveillants (&quot;threat actors&rdquo; - TA) ne s&rsquo;emparent de l&rsquo;exploit pour l&rsquo;incorporer dans leur arsenal, tout d&rsquo;abord pour profiter du fameux &ldquo;dwell time&rdquo; (le temps écoulé entre la publication d&rsquo;une vulnérabilité et l&rsquo;application de son correctif).
Ainsi, des nombreux TA ont armé la vulnérabilité dans leur kit d&rsquo;exploitation en modifiant leurs mode opératoire (TTPs) en conséquence, avec un succès assez variable." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://unic0rn-team.github.io/post/cve-30190-3/" />
<meta property="article:published_time" content="2022-07-08T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-07-08T00:00:00+00:00" /><meta property="og:site_name" content="unic0rn-team&#39;s billets" />






  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a
  href="https://unic0rn-team.github.io/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >hello friend</span
    >
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/archive">Archive</a></li>
        
      
        
          <li><a href="/showcase">Showcase</a></li>
        
      
      
      
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/archive">Archive</a></li>
      
    
      
        <li><a href="/showcase">Showcase</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none" />
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg
  class="theme-toggler"
  width="24"
  height="24"
  viewBox="0 0 48 48"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"
  />
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h1 class="post-title">CVE-2022-30190 &ldquo;Follina&rdquo; - part 3</h1>
    <div class="post-meta">
      
        <span class="post-date">
          2022-07-08
        </span>

        
          
        
      

      
        <span class="post-author"
          >— Written by unic0rn-team</span
        >


      
    </div>

    

    

    <div class="post-content">
      
      <h2 id="-billet-3"># Billet 3</h2>
<h2 id="tl-dr">TL-DR;</h2>
<p>Dès lors que des démonstrateurs (POCs) sont publiés, il n&rsquo;est qu&rsquo;une question de temps avant que les acteurs malveillants (&quot;<em>threat actors</em>&rdquo; - TA) ne s&rsquo;emparent de l&rsquo;exploit pour l&rsquo;incorporer dans leur arsenal, tout d&rsquo;abord pour profiter du fameux &ldquo;<strong>dwell time</strong>&rdquo; (le temps écoulé entre la publication d&rsquo;une vulnérabilité et l&rsquo;application de son correctif).</p>
<p>Ainsi, des nombreux TA ont armé la vulnérabilité dans leur kit d&rsquo;exploitation en modifiant leurs mode opératoire (TTPs) en conséquence, avec un succès assez variable. Même si des contremesures ont été rendues publiques (y compris par Microsoft comme on a vu précedement) des échantillons de documents malicieux qui tentent l&rsquo;exploit sont rapportés encore quotidiennement ITW.</p>
<h3 id="3lexploit-façon-qakbot"><strong>3.L&rsquo;exploit façon Qakbot</strong></h3>
<p><strong>Qakbot</strong>, également connu sous le nom de &ldquo;Qbot&rdquo; ou &ldquo;Pinkslipbot&rdquo;, est un cheval de Troie bancaire actif depuis au moins 2007, dont l&rsquo;objectif est de voler les données des utilisateurs et leurs identifiants bancaires. Au fil du temps, le malware a évolué pour inclure de nouveaux mécanismes de diffusion, des techniques de commande et de contrôle (C2) et des fonctions anti-analyse. Les infections par Qakbot sont déclanchés à travers des campagnes de phishing en s&rsquo;appuyant sur une autre fonctionnalité intéressante:  la possibilité de voler des courriels (&quot;<em>email hijacking</em>&quot;). Ceux-ci sont ensuite utilisés par les attaquants pour envoyer des e-mails ciblés aux victimes, les informations ainsi obtenues étant utilisées pour les inciter à ouvrir ces e-mails.</p>
<p>Qakbot a modifié depuis 2020 ses objectifs pour proposer des plates-formes d&rsquo;attaque post-compromission (mouvement latéral -&quot;<em>spreaders</em>&quot;) telles que Cobalt Strike Beacon, avec pour but final de charger des <strong>ransomwares</strong>, notamment ProLock et, plus récemment, Egregor. Tous les affiliés au TA profitent ainsi des outils d&rsquo;accès initial et des techniques d&rsquo;exploitation offertes par ce malware.</p>
<p>Historiquement, Qakbot s&rsquo;installait sous la forme d&rsquo;un EXE au nom aléatoire dans un sous-répertoire  de <em>AppData\Microsoft</em>. Cependant, au cours de la seconde moitié de l&rsquo;année 2020, Qakbot est passé à l&rsquo;utilisation d&rsquo;une DLL au lieu d&rsquo;un EXE. L&rsquo;utilisation d&rsquo;une DLL offre plus de flexibilité pour échapper à la défense par le biais de l&rsquo;exécution par procuration de binaires signés (<a href="https://redcanary.com/threat-detection-report/techniques/signed-binary-process-execution/">Signed Binary Proxy Execution</a>) en utilisant <a href="https://attack.mitre.org/techniques/T1218/010/">regsrv32.exe</a> ou <a href="https://redcanary.com/threat-detection-report/techniques/rundll32/">rundll32.exe</a> .</p>
<p><strong>Regsvr32.exe</strong> est un programme utilisé pour <strong>enregistrer et désenregistrer les contrôles OLE</strong>, y compris les librairies DLL, sur les systèmes Windows. L&rsquo;abus de Regsvr32.exe peut contourner le déclenchement des alertes de sécurité (Windows utilise regsvr32.exe pour des opérations normales). Regsvr32.exe peut également être utilisé pour contourner spécifiquement le contrôle des applications ( &lsquo;<a href="https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/windows-defender-application-control">Windows Defender Application Control</a> ) à l&rsquo;aide des scriptlets COM pour exécuter des DLL sous les autorisations de l&rsquo;utilisateur.</p>
<p><strong>Rundll32.exe</strong> est un processus natif de Windows et un composant fonctionnel du système d&rsquo;opération qui ne peut pas être bloqué ou désactivé sans provoquer de problèmes. Les adversaires abusent généralement de Rundll32 car il est difficile de différencier les activités malveillantes des ses opérations normales. D&rsquo;un point de vue pratique, Rundll32 permet l&rsquo;<strong>exécution de librairies DLL</strong>, le lancement du code malveillant sous forme de DLL étant, à cause de cela, relativement discrète. Dans ces conditions, l&rsquo;exécution via Rundll32 peut contourner aussi les solutions de contrôle des applications (Windows Defender).</p>
<p>Les fichiers DLL malveillants utilisés pour les infections Qakbot contiennent une étiquette indiquant leur <strong>canal de distribution</strong> (&quot;<em>distribution channel</em>&quot;) spécifique. Par exemple, les échantillons de DLL Qakbot étiquetés &ldquo;obama&rdquo; ( comme par exemple &ldquo;obama186&rdquo; ou &ldquo;obama187&rdquo;)  indiquent un canal de distribution utilisé par un TA spécifique.</p>
<p>Un des acteurs à motivation financière (&quot;<em>eCrime</em>&quot;) des plus prolifiques qui utilise Qakbot est <strong>TA570</strong> ( <a href="https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware">Proofpoint</a>) aussi suivi sous le nom de <strong>Mallard Spider</strong> (<a href="https://www.crowdstrike.com/blog/duck-hunting-with-falcon-complete-analyzing-a-fowl-banking-trojan-part-1/">Crowdstrike</a>) ou <strong>UNC2500</strong> (<a href="https://experience.mandiant.com/trending-evil-2/p/1">Mandiant</a>). Le 07.06.2022, Proofpoint ainsi que des <a href="https://twitter.com/pr0xylife/status/1534212345341288455">divers chercheurs</a> ont signalé que la distribution TA570 de Qakbot comprenait des documents Word utilisant l&rsquo;exploit CVE-2022-30190 (ms-msdt). Dans ce qui suit on va analyser le kill-chain de cette campagne pour comprendre comment et à quel fin le TA a inclus l&rsquo;exploit de cette vulnérabilité dans son arsenal.</p>
<h4 id="vecteur-dattaque-initial">Vecteur d&rsquo;attaque initial</h4>
<p>On commence par le message de phishing (359a6969d641a9c589acfc89b514f58161c89dcdd18a6838c5110cdf1a62e352) envoyé par l&rsquo;attaquant :</p>
<p><img src="/img/img44.png" alt=""></p>
<p><em><strong>Image1:</strong></em> <em>Le courriel de phishing</em></p>
<p>On peut voir que celui-ci contient du texte conçu pour inciter à l&rsquo;ouverture de la pièce jointe (&quot;<em>lure</em>&quot;). Un bref regard suffit pour s&rsquo;apercevoir qu&rsquo;il s&rsquo;agit en fait d&rsquo;un détournement de fil de discussion mail ( &ldquo;<em>mail thread hijacking</em>&quot;), l&rsquo;expediteur et le destinataire étant identiques - <strong>usurpation d&rsquo;identité</strong> (&quot;<em>spoofing</em>&quot;) afin de détourner l&rsquo;attention du destinataire . Le <strong>spoofing</strong> est une technique par laquelle on déguise une communication provenant d&rsquo;une source inconnue en une communication provenant d&rsquo;une source connue et fiable.</p>
<p><img src="/img/img45.png" alt=""></p>
<p><em><strong>Image2:</strong></em>  <em>L&rsquo;adresse de l&rsquo;expediteur est usurpé</em></p>
<p>La pièce jointe est un fichier HTML (1513769188ac6bf68f87b33ed00555126bc68976c4d4022e040547a8814435dc) qu&rsquo;il convient d&rsquo;analyser :</p>
<p><img src="/img/img48.png" alt=""></p>
<p><em><strong>Image 3:</strong></em> <em>Le fichier HTML en pièce jointe</em></p>
<p>Celui-ci contient du javascript qui assigne à une variable &ldquo;<em>text</em>&rdquo; un blob en base64 ( tableau d&rsquo;octets instantialisé a l&rsquo;aide de la fonction <em>b64toBlob</em> )</p>
<p><img src="/img/img49.png" alt=""></p>
<p><em><strong>Image4:</strong></em> <em>La variable text avec un blob en base64</em></p>
<p>A l&rsquo;ouverture du fichier dans le navigateur ce blob est télécharge en tant que <strong>20715533_822431.zip</strong> (7a42a6182fc3b96b3de4aace5cc97c7c28017d9cfa154c410829caac3ca612c4)</p>
<p><img src="/img/img50.png" alt=""></p>
<p><em><strong>Figure 5:</strong></em> <em>Implémentation de la fonctionnalité de téléchargement à l&rsquo;ouverture du fichier</em></p>
<p><img src="/img/img51.png" alt=""></p>
<p><em><strong>Figure 6:</strong></em> <em>Sauvegarde de l&rsquo;archive zip</em></p>
<p>Pour comprendre le mécanisme employé ici on s&rsquo;intéresse à la création du blob hébergé dans la variable test. Si on décode les premiers octets en base64 (&ldquo;JEsDB&rdquo;) on obtient la siganture (&ldquo;magic number&rdquo;) corrspondant à une archive ZIP (&ldquo;PK.&rdquo; du nom de Phil Katz, le créateur du format) :</p>
<p><img src="/img/img73.png" alt=""></p>
<p><img src="/img/img74.png" alt=""></p>
<p><em><strong>Figure 7:</strong></em> <em>La signature PK du blob</em></p>
<p>Ensuite on remarque que le code JS utilise la méthode <a href="https://developer.mozilla.org/en-US/docs/Web/API/BlobBuilder">msSaveOrOpenBlob</a> du constructor Blob de l&rsquo;<strong>API BlobBuilder</strong> ce qui va permettre l&rsquo;initiation du téléchargement dès l&rsquo;ouverture du fichier dans le navigateur en tant que <strong>20755103_822431.zip</strong> :</p>
<p><img src="/img/img75.jpg" alt=""></p>
<p>Cette technique adopté par les opérateurs Qakbot à partir de la campagne &ldquo;obama186&rdquo; est toujours utilisée, ce qui permet quelques opportunités de détection fiables, notamment à l&rsquo;aide des signatures Yara.</p>
<p>Lorsqu&rsquo;on extrait l&rsquo;archive on obtient un fichier**.img**(<a href="https://www.virustotal.com/gui/file/85b4504543ed58861a85899b4c1cd315fbc9bd31540ce74e7730495a9384eef2">85b4504543ed58861a85899b4c1cd315fbc9bd31540ce74e7730495a9384eef2</a>) - fichier d&rsquo;image disque créé par diverses applications d&rsquo;imagerie - avec un nom identique :</p>
<p><img src="/img/img52.png" alt=""></p>
<p><img src="/img/img53.png" alt=""></p>
<p><img src="/img/img54.png" alt=""></p>
<p><em><strong>Figure 8:</strong></em> <em>Extraction du fichier .img</em></p>
<p>A l&rsquo;exécution, son contenu est présenté par l&rsquo;explorateur de fichiers comme suit:</p>
<p><img src="/img/img67.png" alt=""></p>
<p><em><strong>Figure 9:</strong></em> <em>Contenu du fichier .img</em></p>
<p>On y trouve donc une <strong>librarie .dll cachée</strong> (17af3b12512b3430d59ca594bc16171c66ec49db4458cb2de887b83e9f37860b), un <strong>fichier .lnk</strong> (<a href="https://www.virustotal.com/gui/file/03160be7cb698e1684f47071cb441ff181ff299cb38429636d11542ba8d306ae">03160be7cb698e1684f47071cb441ff181ff299cb38429636d11542ba8d306ae</a>) et un <strong>fichier .docx</strong> (<a href="https://www.virustotal.com/gui/file/d20120cc046cef3c3f0292c6cbc406fcf2a714aa8e048c9188f1184e4bb16c93">d20120cc046cef3c3f0292c6cbc406fcf2a714aa8e048c9188f1184e4bb16c93</a>). Le rôle du fichier de raccourci  .lnk est d&rsquo;exécuter  le fichier .dll (invisible sans l&rsquo;activation explicite de la visualisation des fichiers cachés) à l&rsquo;aide de <strong>rundll32.exe</strong></p>
<p><img src="/img/img68.png" alt=""></p>
<p><em><strong>Figure 11:</strong></em> <em>Chemin d&rsquo;exécution du dll dans le fichier .lnk</em></p>
<p>Cette .dll n&rsquo;est rien d&rsquo;autre que le binaire malicieux Qakbot  (comme vu, vecteur privilégié d&rsquo;infection dans les campagnes récentes). En cliquant sur le raccourci on déclenche donc l&rsquo;<strong>infection secondaire</strong> (&ldquo;second stage&rdquo;). A quoi  sert alors le fichier .docx ?</p>
<h4 id="vecteur-alternatif-dattaque">Vecteur alternatif d&rsquo;attaque</h4>
<p>On procède à l&rsquo;analyse du fichier <strong>doc1792.docx</strong> après l&rsquo;extraction, le format .docx n'étant qu&rsquo;une archive zip :</p>
<p><img src="/img/img57.png" alt=""></p>
<p><img src="/img/img58.png" alt=""></p>
<p><em><strong>Figure 12:</strong></em> <em>Dezippage du document .docx</em></p>
<p>En suivant le mode opératoire de l&rsquo;exploit initial on trouve dans word/_rels/<strong>document.xml.rels</strong> un URL qui télécharge (&quot;<em>HTML smuggling</em>&quot;) le fichier <strong>123.RES</strong> (<a href="https://www.virustotal.com/gui/file/e3ba1c45f9dd1f432138654b5f19cf89c55e07219b88aa7628334d38bb036433">e3ba1c45f9dd1f432138654b5f19cf89c55e07219b88aa7628334d38bb036433</a>), qui est en fait, contrairement à son extension, un autre fichier html</p>
<p><img src="/img/img59.png" alt=""></p>
<p><em><strong>Figure 13:</strong></em> <em>HTML smuggling dans le fichier document.xml.rels</em></p>
<p><img src="/img/img60.png" alt=""></p>
<p><em><strong>Figure 14:</strong></em> <em>Deuxième fichier HTML téléchargé à l&rsquo;ouverture du .docx</em></p>
<p>Celui-ci nous affiche un texte &ldquo;Lorem ipsum&rdquo; ( texte de remplacement couramment utilisé pour démontrer la forme visuelle d&rsquo;un document ou d&rsquo;une police de caractères sans s&rsquo;appuyer sur un contenu significatif) en incorporant le désormais habituel script JS abusant de ms-msdt en bas de la page :</p>
<p><img src="/img/img61.png" alt=""></p>
<p><img src="/img/img62.png" alt=""></p>
<p><em><strong>Figure 15:</strong></em> <em>Contenu du nouveau fichier HTML</em></p>
<p>Après le décodage du blob en base64 on obtient le code suivant passé pour exécution à PowerShell</p>
<p><img src="/img/img63.png" alt=""></p>
<p><img src="/img/img64.png" alt=""></p>
<p><em><strong>Figure 16:</strong></em> <em>Décodage du blob en base64</em></p>
<p>Qu&rsquo;est-ce qui se passe ici ? L&rsquo;expression  <strong>iwr</strong> (<a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-webrequest?view=powershell-7.2">Invoke-WebRequest</a>) télécharge trois fichiers .dat depuis trois URLs différentes et les stockent dans un répertoire temporaire. Par la suite ceux-ci seront exécutés à l&rsquo;aide de <strong>regsrv32.exe</strong>.</p>
<p>Si on ouvre 123.RES avec MS Edge l&rsquo;abus du msdt est confirmé &ldquo;de visu&rdquo;</p>
<p><img src="/img/img65.png" alt=""></p>
<p><img src="/img/img66.png" alt=""></p>
<p><em><strong>Figure 17:</strong></em> <em>Exploitation du ms-msdt</em></p>
<p>Les trois fichiers .dat ainsi téléchargés ne sont rien d&rsquo;autre que des <strong>DLL Qakbot &ldquo;obama186&rdquo;</strong> (6a16d1ec263eeacd6d5b2eb1855337a0aeeacd8020df840a0d883f973b3111b7) :</p>
<p><img src="/img/img69.png" alt=""></p>
<p><img src="/img/img70.png" alt=""></p>
<p><em><strong>Figure 18:</strong></em> <em>Format binaire PE de la dll</em></p>
<p>On peut représenter ainsi d&rsquo;une façon synthétique le kill-chain comme suit :</p>
<p><img src="/img/img71.png" alt=""></p>
<h4 id="conclusion">Conclusion</h4>
<p>Les opérateurs du Qakbot, comme souvent les acteurs du monde d&rsquo;eCrime - qui sont parmi les premiers à adopter les 0-Days publiés - ont intégré  très rapidement l&rsquo;exploit dans leur kit <strong>sans pour autant modifier radicalement</strong> leur mode opératoire - <a href="https://www.fortinet.com/blog/threat-research/deep-analysis-of-a-qbot-campaign-part-1">largement documenté</a> dans des <a href="https://securelist.com/qakbot-technical-analysis/103931/">diverses analyses</a> <a href="https://www.binarydefense.com/qakbot-upgrades-to-stealthier-persistence-method/">récentes</a> . La fonctionnalité apporté dans leur arsenal par l&rsquo;exploit semble être celle  d&rsquo;assurer un <strong>chemin d&rsquo;exécution secondaire</strong> pour la détonation de la DLL : si la victime ne clique pas sur le raccourci LNK elle peut en revanche cliquer sur le fichier Word. Le résultat final est le même - installation du binaire Qakbot et compromission de la machine.</p>
<p>Même si la campagne à été de courte durée (48h) un nombre assez important victimes (y compris en France - ici l&rsquo;adresse IP appartenant à un abonné SFR ) ont continué de propager l&rsquo;infection :</p>
<p><img src="/img/img72.png" alt=""></p>
<p><em><strong>Figure 19:</strong></em> <em>Graphique de la campagne Qakbot &ldquo;obama186&rdquo;</em></p>
<p>Evidement par souci de exhaustivité on devra s&rsquo;occuper aussi des DLL récupérés, mais, le sujet étant &ldquo;Follina&rdquo;, leur rétro-ingénierie restera une tâche pour plus tard.</p>
<p><img src="/img/img76.png" alt=""></p>
<p><em><strong>Figure 20:</strong></em> <em>Fonctionnalités du binaire Qakbot</em></p>
<p>A suivre&hellip;</p>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h"
              >Read other posts</span
            >
            <hr />
          </div>
          <div class="pagination__buttons">
            
            
              <span class="button next">
                <a href="https://unic0rn-team.github.io/post/cve-30190-1/">
                  <span class="button__text">CVE-2022-30190 &#34;Follina&#34; - part 1</span>
                  <span class="button__icon">→</span>
                </a>
              </span>
            
          </div>
        </div>
      
    

    
      
        

      
    
  </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <a
  href="https://unic0rn-team.github.io/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >hello friend</span
    >
    <span class="logo__cursor"></span>
  
</a>

      <div class="copyright">
        <span
          >© 2022 Powered by
          <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a></span
        >
        <span
          >Theme created by
          <a href="https://twitter.com/panr" target="_blank" rel="noopener">panr</a></span
        >
      </div>
    
  </div>
</footer>

<script src="https://unic0rn-team.github.io/assets/main.js"></script>
<script src="https://unic0rn-team.github.io/assets/prism.js"></script>


      
    </div>

    
  </body>
</html>
